@command
def test(app):
    run("sh install.sh")
    run("sh uninstall.sh")

@command
def big_test(app):
    test(app)

    if which("dash"):
        run("dash uninstall.sh")
        run("dash install.sh")

        run("dash install.sh")   # Creates a backup
        run("dash install.sh")   # Backs up the backup
        run("dash uninstall.sh") # No backup
        run("dash uninstall.sh") # Creates a backup
        run("dash uninstall.sh") # Backs up the backup

    if which("bash"):
        run("bash uninstall.sh")
        run("bash install.sh")

        run("bash install.sh")   # Creates a backup
        run("bash install.sh")   # Backs up the backup
        run("bash uninstall.sh") # No backup
        run("bash uninstall.sh") # Creates a backup
        run("bash uninstall.sh") # Backs up the backup

@command
def lint(app):
    check_program("shellcheck")

    run("shellcheck --enable all install.sh")

@command
def debug(app, shell="bash"):
    check_program(shell)

    with working_env(DEBUG=1):
        run(f"{shell} -vx install.sh")
