@command
def test(app, shell="sh"):
    check_program(shell)

    run(f"{shell} uninstall.sh")

    run(f"{shell} install.sh") # No backup
    run(f"{shell} install.sh") # Creates a backup
    run(f"{shell} install.sh") # Backs up the backup

    run(f"{shell} uninstall.sh") # No backup
    run(f"{shell} uninstall.sh") # Creates a backup
    run(f"{shell} uninstall.sh") # Backs up the backup

@command
def big_test(app):
    with working_env(DEBUG=1):
        test(app)

    for shell in "bash", "dash", "ksh":
        if not which(shell):
            continue

        test(app, shell=shell)

@command
def lint(app):
    check_program("shellcheck")

    run("shellcheck --enable all install.sh")

@command
def debug(app, shell="bash"):
    check_program(shell)

    with working_env(DEBUG=1):
        run(f"{shell} -vx install.sh")
